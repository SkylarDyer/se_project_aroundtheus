!function(){"use strict";class e{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",this._handleClickOutside),this.close()}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleClickOutside=e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()}}class t extends e{constructor(e,t){super({popupSelector:e}),this._handleFormSubmit=t,this._popupForm=this._popupElement.querySelector(".modal__form"),this._saveButton=this._popupForm.querySelector(".modal__button")}_getInputValues(){const e=this._popupForm.querySelectorAll(".modal__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)}))}close(){this._popupForm.reset(),super.close()}renderLoading(e,t){this._saveButton.textContent=e?"Saving...":t}}var s=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_showInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageEl.textContent=" ",this._errorMessageEl.classList.remove(this._errorClass)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}enableValidation(){this._form.addEventListener("reset",(()=>{this.toggleButtonState()})),this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class r{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class i{constructor(e,t,s,r,i,n,o,a,l,d){this._name=e,this._link=t,this.isLiked=s,this.cardId=i,this._likes=r,this._userId=n,this._cardSelector=d,this._handleCardClick=o,this._handleLikeClick=l,this._handleDeleteClick=a}_setEventListeners(){this._cardLikeButton.addEventListener("click",(()=>this._handleLikeClick(this))),this._cardDeleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick(this._getData())}))}handleDeleteCard(){this._cardElement.remove()}_renderLikes(){this.isLiked?this._cardLikeButton.classList.add("card__like-button_active"):this._cardLikeButton.classList.remove("card__like-button_active")}updateLikes(e){this.isLiked=e,this._renderLikes()}_showCardLikes(){this._cardLikeCounter.textContent=this._likes.length,this.cardIsLiked()?this._cardLikeButton.classList.add("card__like-button_active"):this._cardLikeButton.classList.remove("card__like-button_active")}_getData(){return{name:this._name,link:this._link}}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._cardElement=this._getTemplate(),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardLikeButton=this._cardElement.querySelector(".card__like-button"),this._cardDeleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardLikeCounter=this._cardElement.querySelector(".card__counter"),this._cardLikeCounter.textContent=this._cardLikesCount,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardElement.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._renderLikes(),this._cardElement}}const n={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__error",errorClass:"modal__error_visible"},o=document.querySelector("#add-card-form"),a=document.querySelector("#edit-profile-form"),l=document.querySelector("#change-avi-form"),d=(document.querySelector(".cards__list"),document.querySelector("#owner-name")),c=document.querySelector("#owner-description"),h=(l.querySelector(".change-avi-form__button"),document.querySelector("#profile-avi__image-hover-button")),_=document.querySelector(".profile__add-button"),u=new t("#change-avi-img",(function(e){u.renderLoading(!0),U.updateProfileAvatar(e.avatar).then((()=>{g.setAvatar(e.avatar),u.close()})).catch((e=>{console.log(e)})).finally((()=>{u.renderLoading(!1,"Save")}))})),m=document.querySelector(".profile__edit-button"),p=new class extends e{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._saveButton=this._popupForm.querySelector(".modal__button")}setSubmitAction(e){this._handleConfirm=e}renderLoading(e){this._saveButton.textContent=e?"Loading...":"Yes"}_handleSubmit=e=>{e.preventDefault(),this._handleConfirm()};setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleSubmit)}}("#modal__delete"),v=new class extends e{constructor(e){super({popupSelector:e}),this._previewImgTitle=this._popupElement.querySelector(".modal__image-title"),this._previewImgModal=this._popupElement.querySelector(".modal__image-preview")}open(e){super.open(),this._previewImgModal.src=e.link,this._previewImgModal.alt=e.name,this._previewImgTitle.textContent=e.name}}("#modal-preview",I),L=new t("#profile-edit-modal",(function(e){L.renderLoading(!0),U.updateProfileInfo(e).then((()=>{g.setUserInfo(e),L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.renderLoading(!1,"Save")}))})),E=new t("#card-edit-modal",(function(e){E.renderLoading(!0),U.addNewCard(e).then((e=>{const t=C(e);S.addItem(t),E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.renderLoading(!1,"Create")}))})),k="#card-template",g=new class{constructor(e){this._nameElement=document.querySelector(e.userNameSelector),this._descriptionElement=document.querySelector(e.userDescriptionSelector),this._userAvi=document.querySelector(e.userAvi)}getUserInfo(){return{name:this._nameElement.textContent,about:this._descriptionElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._descriptionElement.textContent=e.about}setAvatar(e){this._userAvi.src=e}}({userNameSelector:".profile__title",userDescriptionSelector:".profile__description",userAvi:".profile__image"});let S,f;function C(e){return new i(e.name,e.link,e.isLiked,e.likes,e._id,f,I,b,y,k).getView()}function b(e){p.open(),p.setSubmitAction((()=>{p.renderLoading(!0),U.deleteCard(e.cardId).then((()=>{e.handleDeleteCard(),p.close()})).catch((e=>{console.log(e)})).finally((()=>{p.renderLoading(!1)}))}))}function y(e){e.isLiked?U.removeCardLikes(e.cardId).then((t=>{e.updateLikes(t.isLiked)})).catch((e=>{console.log(e)})):U.addCardLikes(e.cardId).then((t=>{e.updateLikes(t.isLiked)})).catch((e=>{console.log(e)}))}function I(e){v.open(e)}const q=new s(n,l),B=new s(n,a),w=new s(n,o);B.enableValidation(),w.enableValidation(),q.enableValidation(),h.addEventListener("click",(()=>{q.toggleButtonState(),u.open()})),m.addEventListener("click",(()=>{!function(){const e=g.getUserInfo();d.value=e.name,c.value=e.about,L.open()}(),B.resetValidation})),_.addEventListener("click",(()=>{w.resetValidation,w.toggleButtonState(),E.open()})),v.setEventListeners(),L.setEventListeners(),p.setEventListeners(),E.setEventListeners(),u.setEventListeners();const U=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}updateProfileInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addCardLikes(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeCardLikes(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}updateProfileAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"8d1c8a4d-d591-4303-89c5-4b1506b830b3","Content-Type":"application/json"}});Promise.all([U.getUserInfo(),U.getInitialCards()]).then((e=>{let[t,s]=e;g.setUserInfo(t),g.setAvatar(t.avatar),f=t._id,S=new r({items:s,renderer:e=>{const t=C(e);S.addItem(t)}},".cards__list"),S.renderItems()})).catch(console.error)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDbkJDLFlBQVdDLEdBQW9CLElBQW5CLGNBQUVDLEdBQWVELEVBQzNCRSxLQUFLQyxjQUFnQkMsU0FBU0MsY0FBY0osR0FDNUNDLEtBQUtJLGdCQUFrQkosS0FBS0ksZ0JBQWdCQyxLQUFLTCxLQUNuRCxDQUVBSSxnQkFBZ0JFLEdBQ0UsV0FBWkEsRUFBSUMsS0FDTlAsS0FBS1EsT0FFVCxDQUVBQyxvQkFDRVQsS0FBS0MsY0FBY1MsaUJBQWlCLFlBQWFWLEtBQUtXLHFCQUN0RFgsS0FBS1EsT0FDUCxDQUVBSSxPQUNFWixLQUFLQyxjQUFjWSxVQUFVQyxJQUFJLGdCQUNqQ1osU0FBU1EsaUJBQWlCLFFBQVNWLEtBQUtJLGdCQUMxQyxDQUVBSSxRQUNFUixLQUFLQyxjQUFjWSxVQUFVRSxPQUFPLGdCQUNwQ2IsU0FBU2Msb0JBQW9CLFFBQVNoQixLQUFLSSxnQkFDN0MsQ0FFQU8sb0JBQXVCTCxLQUVuQkEsRUFBSVcsT0FBT0osVUFBVUssU0FBUyxpQkFDOUJaLEVBQUlXLE9BQU9KLFVBQVVLLFNBQVMsa0JBRTlCbEIsS0FBS1EsT0FDUCxFQy9CVyxNQUFNVyxVQUFzQnZCLEVBQ3pDQyxZQUFZRSxFQUFlcUIsR0FDekJDLE1BQU0sQ0FBRXRCLGtCQUNSQyxLQUFLc0Isa0JBQW9CRixFQUN6QnBCLEtBQUt1QixXQUFhdkIsS0FBS0MsY0FBY0UsY0FBYyxnQkFDbkRILEtBQUt3QixZQUFjeEIsS0FBS3VCLFdBQVdwQixjQUFjLGlCQUNuRCxDQUVBc0Isa0JBQ0UsTUFBTUMsRUFBUzFCLEtBQUt1QixXQUFXSSxpQkFBaUIsaUJBQzFDQyxFQUFTLENBQUMsRUFJaEIsT0FIQUYsRUFBT0csU0FBU0MsSUFDZEYsRUFBT0UsRUFBTUMsTUFBUUQsRUFBTUUsS0FBSyxJQUUzQkosQ0FDVCxDQUVBbkIsb0JBQ0VZLE1BQU1aLG9CQUNOVCxLQUFLdUIsV0FBV2IsaUJBQWlCLFVBQVd1QixJQUMxQ0EsRUFBRUMsaUJBQ0YsTUFBTUMsRUFBY25DLEtBQUt5QixrQkFDekJ6QixLQUFLc0Isa0JBQWtCYSxFQUFZLEdBRXZDLENBRUEzQixRQUNFUixLQUFLdUIsV0FBV2EsUUFDaEJmLE1BQU1iLE9BQ1IsQ0FFQTZCLGNBQWNDLEVBQVdDLEdBRXJCdkMsS0FBS3dCLFlBQVlnQixZQURmRixFQUM2QixZQUVBQyxDQUVuQyxFQzZCRixNQXBFQSxNQUNFMUMsWUFBWTRDLEVBQVVDLEdBQ3BCMUMsS0FBSzJDLGVBQWlCRixFQUFTRyxjQUMvQjVDLEtBQUs2QyxzQkFBd0JKLEVBQVNLLHFCQUN0QzlDLEtBQUsrQyxxQkFBdUJOLEVBQVNPLG9CQUNyQ2hELEtBQUtpRCxpQkFBbUJSLEVBQVNTLGdCQUNqQ2xELEtBQUttRCxZQUFjVixFQUFTVyxXQUM1QnBELEtBQUtxRCxNQUFRWCxDQUNmLENBRUFZLG9CQUNNdEQsS0FBS3VELG9CQUNQdkQsS0FBS3dELGNBQWMzQyxVQUFVQyxJQUFJZCxLQUFLK0Msc0JBQ3RDL0MsS0FBS3dELGNBQWNDLFVBQVcsSUFFOUJ6RCxLQUFLd0QsY0FBYzNDLFVBQVVFLE9BQU9mLEtBQUsrQyxzQkFDekMvQyxLQUFLd0QsY0FBY0MsVUFBVyxFQUVsQyxDQUVBQyxvQkFBb0JDLEdBQ2xCLElBQUtBLEVBQVFDLFNBQVNDLE1BQ3BCLE9BQU83RCxLQUFLOEQsZ0JBQWdCSCxHQUc5QjNELEtBQUsrRCxnQkFBZ0JKLEVBQ3ZCLENBRUFHLGdCQUFnQkgsR0FDZDNELEtBQUtnRSxnQkFBa0JoRSxLQUFLcUQsTUFBTWxELGNBQWUsSUFBR3dELEVBQVFNLFlBQzVETixFQUFROUMsVUFBVUMsSUFBSWQsS0FBS2lELGtCQUMzQmpELEtBQUtnRSxnQkFBZ0J4QixZQUFjbUIsRUFBUU8sa0JBQzNDbEUsS0FBS2dFLGdCQUFnQm5ELFVBQVVDLElBQUlkLEtBQUttRCxZQUMxQyxDQUNBWSxnQkFBZ0JKLEdBQ2QzRCxLQUFLZ0UsZ0JBQWtCaEUsS0FBS3FELE1BQU1sRCxjQUFlLElBQUd3RCxFQUFRTSxZQUM1RE4sRUFBUTlDLFVBQVVFLE9BQU9mLEtBQUtpRCxrQkFDOUJqRCxLQUFLZ0UsZ0JBQWdCeEIsWUFBYyxJQUNuQ3hDLEtBQUtnRSxnQkFBZ0JuRCxVQUFVRSxPQUFPZixLQUFLbUQsWUFDN0MsQ0FFQWdCLHFCQUNFbkUsS0FBS29FLFVBQVksSUFBSXBFLEtBQUtxRCxNQUFNMUIsaUJBQWlCM0IsS0FBSzJDLGlCQUN0RDNDLEtBQUt3RCxjQUFnQnhELEtBQUtxRCxNQUFNbEQsY0FBY0gsS0FBSzZDLHVCQUNuRDdDLEtBQUtvRSxVQUFVdkMsU0FBUzhCLElBQ3RCQSxFQUFRakQsaUJBQWlCLFNBQVMsS0FDaENWLEtBQUswRCxvQkFBb0JDLEdBQ3pCM0QsS0FBS3NELG1CQUFtQixHQUN4QixHQUVOLENBRUFDLG1CQUNFLE9BQVF2RCxLQUFLb0UsVUFBVUMsT0FBT1YsR0FBWUEsRUFBUUMsU0FBU0MsT0FDN0QsQ0FFQVMsbUJBQ0V0RSxLQUFLcUQsTUFBTTNDLGlCQUFpQixTQUFTLEtBQ25DVixLQUFLc0QsbUJBQW1CLElBRTFCdEQsS0FBS3FELE1BQU0zQyxpQkFBaUIsVUFBV3VCLElBQ3JDQSxFQUFFQyxnQkFBZ0IsSUFHcEJsQyxLQUFLbUUsb0JBQ1AsR0NqRWEsTUFBTUksRUFDbkIxRSxZQUFXQyxFQUFzQjBFLEdBQVcsSUFBaEMsTUFBRUMsRUFBSyxTQUFFQyxHQUFVNUUsRUFDN0JFLEtBQUsyRSxPQUFTRixFQUNkekUsS0FBSzRFLFVBQVlGLEVBQ2pCMUUsS0FBSzZFLFdBQWEzRSxTQUFTQyxjQUFjcUUsRUFDM0MsQ0FFQU0sY0FDRTlFLEtBQUsyRSxPQUFPOUMsU0FBU2tELElBQ25CL0UsS0FBSzRFLFVBQVVHLEVBQUssR0FFeEIsQ0FFQUMsUUFBUUQsR0FDTi9FLEtBQUs2RSxXQUFXSSxRQUFRRixFQUMxQixFQ2ZhLE1BQU1HLEVBQ25CckYsWUFDRWtDLEVBQ0FvRCxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUVBM0YsS0FBSzRGLE1BQVE3RCxFQUNiL0IsS0FBSzZGLE1BQVFWLEVBQ2JuRixLQUFLb0YsUUFBVUEsRUFDZnBGLEtBQUtzRixPQUFTQSxFQUNkdEYsS0FBSzhGLE9BQVNULEVBQ2RyRixLQUFLK0YsUUFBVVIsRUFDZnZGLEtBQUtnRyxjQUFnQkwsRUFDckIzRixLQUFLaUcsaUJBQW1CVCxFQUN4QnhGLEtBQUtrRyxpQkFBbUJSLEVBQ3hCMUYsS0FBS21HLG1CQUFxQlYsQ0FDNUIsQ0FFQXRCLHFCQUNFbkUsS0FBS29HLGdCQUFnQjFGLGlCQUFpQixTQUFTLElBQzdDVixLQUFLa0csaUJBQWlCbEcsUUFFeEJBLEtBQUtxRyxrQkFBa0IzRixpQkFBaUIsU0FBUyxLQUMvQ1YsS0FBS21HLG1CQUFtQm5HLEtBQUssSUFFL0JBLEtBQUtzRyxXQUFXNUYsaUJBQWlCLFNBQVMsS0FDeENWLEtBQUtpRyxpQkFBaUJqRyxLQUFLdUcsV0FBVyxHQUUxQyxDQUVBQyxtQkFDRXhHLEtBQUt5RyxhQUFhMUYsUUFDcEIsQ0FFQTJGLGVBQ00xRyxLQUFLb0YsUUFDUHBGLEtBQUtvRyxnQkFBZ0J2RixVQUFVQyxJQUFJLDRCQUVuQ2QsS0FBS29HLGdCQUFnQnZGLFVBQVVFLE9BQU8sMkJBRTFDLENBRUE0RixZQUFZdkIsR0FDVnBGLEtBQUtvRixRQUFVQSxFQUNmcEYsS0FBSzBHLGNBQ1AsQ0FFQUUsaUJBQ0U1RyxLQUFLNkcsaUJBQWlCckUsWUFBY3hDLEtBQUs4RixPQUFPZ0IsT0FDNUM5RyxLQUFLK0csY0FDUC9HLEtBQUtvRyxnQkFBZ0J2RixVQUFVQyxJQUFJLDRCQUVuQ2QsS0FBS29HLGdCQUFnQnZGLFVBQVVFLE9BQU8sMkJBRTFDLENBRUF3RixXQUNFLE1BQU8sQ0FDTHhFLEtBQU0vQixLQUFLNEYsTUFDWFQsS0FBTW5GLEtBQUs2RixNQUVmLENBRUFtQixlQUNFLE9BQU85RyxTQUNKQyxjQUFjSCxLQUFLZ0csZUFDbkJpQixRQUFROUcsY0FBYyxTQUN0QitHLFdBQVUsRUFDZixDQUVBQyxVQWdCRSxPQWZBbkgsS0FBS3lHLGFBQWV6RyxLQUFLZ0gsZUFDekJoSCxLQUFLc0csV0FBYXRHLEtBQUt5RyxhQUFhdEcsY0FBYyxnQkFDbERILEtBQUtvRyxnQkFDSHBHLEtBQUt5RyxhQUFhdEcsY0FBYyxzQkFDbENILEtBQUtxRyxrQkFBb0JyRyxLQUFLeUcsYUFBYXRHLGNBQ3pDLHdCQUVGSCxLQUFLNkcsaUJBQW1CN0csS0FBS3lHLGFBQWF0RyxjQUFjLGtCQUN4REgsS0FBSzZHLGlCQUFpQnJFLFlBQWN4QyxLQUFLb0gsZ0JBQ3pDcEgsS0FBS3NHLFdBQVdlLElBQU1ySCxLQUFLNkYsTUFDM0I3RixLQUFLc0csV0FBV2dCLElBQU10SCxLQUFLNEYsTUFDM0I1RixLQUFLeUcsYUFBYXRHLGNBQWMsZ0JBQWdCcUMsWUFBY3hDLEtBQUs0RixNQUNuRTVGLEtBQUttRSxxQkFDTG5FLEtBQUswRyxlQUVFMUcsS0FBS3lHLFlBQ2QsRUM5RkssTUFTTWMsRUFBc0IsQ0FDakNDLGFBQWMsZUFDZDVFLGNBQWUsZ0JBQ2ZFLHFCQUFzQixpQkFDdEJFLG9CQUFxQix5QkFDckJFLGdCQUFpQixlQUNqQkUsV0FBWSx3QkFHRHFFLEVBQWN2SCxTQUFTQyxjQUFjLGtCQUNyQ3VILEVBQWtCeEgsU0FBU0MsY0FBYyxzQkFDekN3SCxFQUFjekgsU0FBU0MsY0FBYyxvQkFFckN5SCxHQURZMUgsU0FBU0MsY0FBYyxnQkFDbkJELFNBQVNDLGNBQWMsZ0JBQ3ZDMEgsRUFDWDNILFNBQVNDLGNBQWMsc0JBRVoySCxHQURZSCxFQUFZeEgsY0FBYyw0QkFDdEJELFNBQVNDLGNBQ3BDLHFDQUVXNEgsRUFBZ0I3SCxTQUFTQyxjQUFjLHdCQ0g5QzZILEVBQWMsSUFBSTdHLEVEcEJOLG1CQzRGbEIsU0FBd0JnQixHQUN0QjZGLEVBQVkzRixlQUFjLEdBQzFCNEYsRUFDR0Msb0JBQW9CL0YsRUFBWWdHLFFBQ2hDQyxNQUFLLEtBQ0pDLEVBQVNDLFVBQVVuRyxFQUFZZ0csUUFDL0JILEVBQVl4SCxPQUFPLElBRXBCK0gsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQUVqQkcsU0FBUSxLQUNQWCxFQUFZM0YsZUFBYyxFQUFPLE9BQU8sR0FFOUMsSUFyRk11RyxFQUFvQjFJLFNBQVNDLGNBQWMseUJBQzNDMEksRUFBa0IsSUMxQlQsY0FBb0NqSixFQUNqREMsWUFBWUUsR0FDVnNCLE1BQU0sQ0FBRXRCLGtCQUNSQyxLQUFLdUIsV0FBYXZCLEtBQUtDLGNBQWNFLGNBQWMsZ0JBQ25ESCxLQUFLd0IsWUFBY3hCLEtBQUt1QixXQUFXcEIsY0FBYyxpQkFDbkQsQ0FFQTJJLGdCQUFnQkMsR0FDZC9JLEtBQUtnSixlQUFpQkQsQ0FDeEIsQ0FFQTFHLGNBQWNDLEdBRVZ0QyxLQUFLd0IsWUFBWWdCLFlBRGZGLEVBQzZCLGFBRUEsS0FFbkMsQ0FFQTJHLGNBQWlCM0ksSUFDZkEsRUFBSTRCLGlCQUNKbEMsS0FBS2dKLGdCQUFnQixFQUd2QnZJLG9CQUNFWSxNQUFNWixvQkFDTlQsS0FBS3VCLFdBQVdiLGlCQUFpQixTQUFVVixLQUFLaUosY0FDbEQsR0REZ0Qsa0JBQzVDQyxFQUFvQixJRTNCWCxjQUE2QnRKLEVBQzFDQyxZQUFZRSxHQUNWc0IsTUFBTSxDQUFFdEIsa0JBQ1JDLEtBQUttSixpQkFBbUJuSixLQUFLQyxjQUFjRSxjQUN6Qyx1QkFFRkgsS0FBS29KLGlCQUFtQnBKLEtBQUtDLGNBQWNFLGNBQ3pDLHdCQUVKLENBRUFTLEtBQUt5SSxHQUNIaEksTUFBTVQsT0FDTlosS0FBS29KLGlCQUFpQi9CLElBQU1nQyxFQUFLbEUsS0FDakNuRixLQUFLb0osaUJBQWlCOUIsSUFBTStCLEVBQUt0SCxLQUNqQy9CLEtBQUttSixpQkFBaUIzRyxZQUFjNkcsRUFBS3RILElBQzNDLEdIZmMsaUJDNEJkeUQsR0FFSThELEVBQW1CLElBQUluSSxFRDVCTCx1QkM4RHhCLFNBQWlDZ0IsR0FDL0JtSCxFQUFpQmpILGVBQWMsR0FDL0I0RixFQUNHc0Isa0JBQWtCcEgsR0FDbEJpRyxNQUFLLEtBQ0pDLEVBQVNtQixZQUFZckgsR0FDckJtSCxFQUFpQjlJLE9BQU8sSUFFekIrSCxPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixFQUFJLElBRWpCRyxTQUFRLEtBQ1BXLEVBQWlCakgsZUFBYyxFQUFPLE9BQU8sR0FFbkQsSUE1Q01vSCxFQUFlLElBQUl0SSxFRGpDSixvQkM4RXJCLFNBQTRCZ0IsR0FDMUJzSCxFQUFhcEgsZUFBYyxHQUMzQjRGLEVBQ0d5QixXQUFXdkgsR0FDWGlHLE1BQU11QixJQUNMLE1BQU1DLEVBQVVDLEVBQVdGLEdBQzNCRyxFQUFlOUUsUUFBUTRFLEdBQ3ZCSCxFQUFhakosT0FBTyxJQUVyQitILE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLEVBQUksSUFFakJHLFNBQVEsS0FDUGMsRUFBYXBILGVBQWMsRUFBTyxTQUFTLEdBRWpELElBeERNc0QsRUR2Q1UsaUJDd0NWMEMsRUFBVyxJRzFDRixNQUNieEksWUFBWWtLLEdBQ1YvSixLQUFLZ0ssYUFBZTlKLFNBQVNDLGNBQWM0SixFQUFVRSxrQkFDckRqSyxLQUFLa0ssb0JBQXNCaEssU0FBU0MsY0FDbEM0SixFQUFVSSx5QkFFWm5LLEtBQUtvSyxTQUFXbEssU0FBU0MsY0FBYzRKLEVBQVVNLFFBQ25ELENBRUFDLGNBQ0UsTUFBTyxDQUNMdkksS0FBTS9CLEtBQUtnSyxhQUFheEgsWUFDeEIrSCxNQUFPdkssS0FBS2tLLG9CQUFvQjFILFlBRXBDLENBRUFnSCxZQUFZckgsR0FDVm5DLEtBQUtnSyxhQUFheEgsWUFBY0wsRUFBWUosS0FDNUMvQixLQUFLa0ssb0JBQW9CMUgsWUFBY0wsRUFBWW9JLEtBQ3JELENBRUFqQyxVQUFVSCxHQUNSbkksS0FBS29LLFNBQVMvQyxJQUFNYyxDQUN0QixHSG1CNEIsQ0FDNUI4QixpQkFBa0Isa0JBQ2xCRSx3QkFBeUIsd0JBQ3pCRSxRQUFTLG9CQUtYLElBQUlQLEVBQ0F2RSxFQUNKLFNBQVNzRSxFQUFXRixHQWFsQixPQVphLElBQUl6RSxFQUNmeUUsRUFBUzVILEtBQ1Q0SCxFQUFTeEUsS0FDVHdFLEVBQVN2RSxRQUNUdUUsRUFBU3RFLE1BQ1RzRSxFQUFTYSxJQUNUakYsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsR0FFVXdCLFNBQ2QsQ0ErQ0EsU0FBUzFCLEVBQWtCZ0YsR0FDekI1QixFQUFnQmpJLE9BQ2hCaUksRUFBZ0JDLGlCQUFnQixLQUM5QkQsRUFBZ0J4RyxlQUFjLEdBQzlCNEYsRUFDR3lDLFdBQVdELEVBQUtuRixRQUNoQjhDLE1BQUssS0FDSnFDLEVBQUtqRSxtQkFDTHFDLEVBQWdCckksT0FBTyxJQUd4QitILE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLEVBQUksSUFFakJHLFNBQVEsS0FDUEUsRUFBZ0J4RyxlQUFjLEVBQU0sR0FDcEMsR0FFUixDQU9BLFNBQVNxRCxFQUFnQitFLEdBQ25CQSxFQUFLckYsUUFDUDZDLEVBQ0cwQyxnQkFBZ0JGLEVBQUtuRixRQUNyQjhDLE1BQU13QyxJQUNMSCxFQUFLOUQsWUFBWWlFLEVBQUl4RixRQUFRLElBRTlCbUQsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxJQUdwQlAsRUFDRzRDLGFBQWFKLEVBQUtuRixRQUNsQjhDLE1BQU13QyxJQUNMSCxFQUFLOUQsWUFBWWlFLEVBQUl4RixRQUFRLElBRTlCbUQsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSUYsRUFBSSxHQUd4QixDQUNBLFNBQVNoRCxFQUFnQm1FLEdBQ3ZCVCxFQUFrQnRJLEtBQUsrSSxFQUN6QixDQUlBLE1BQU1tQixFQUFtQixJQUFJQyxFQUFjeEQsRUFBcUJJLEdBQzFEcUQsRUFBMkIsSUFBSUQsRUFDbkN4RCxFQUNBRyxHQUVJdUQsRUFBdUIsSUFBSUYsRUFDL0J4RCxFQUNBRSxHQUVGdUQsRUFBeUIxRyxtQkFDekIyRyxFQUFxQjNHLG1CQUNyQndHLEVBQWlCeEcsbUJBSWpCd0QsRUFBY3BILGlCQUFpQixTQUFTLEtBQ3RDb0ssRUFBaUJ4SCxvQkFDakIwRSxFQUFZcEgsTUFBTSxJQUVwQmdJLEVBQWtCbEksaUJBQWlCLFNBQVMsTUFwRDVDLFdBQ0UsTUFBTXdLLEVBQU83QyxFQUFTaUMsY0FDdEIxQyxFQUFjNUYsTUFBUWtKLEVBQUtuSixLQUMzQjhGLEVBQXFCN0YsTUFBUWtKLEVBQUtYLE1BQ2xDakIsRUFBaUIxSSxNQUNuQixDQWdERXVLLEdBQ0FILEVBQXlCSSxlQUFlLElBRTFDckQsRUFBY3JILGlCQUFpQixTQUFTLEtBQ3RDdUssRUFBcUJHLGdCQUNyQkgsRUFBcUIzSCxvQkFDckJtRyxFQUFhN0ksTUFBTSxJQUVyQnNJLEVBQWtCekksb0JBQ2xCNkksRUFBaUI3SSxvQkFDakJvSSxFQUFnQnBJLG9CQUNoQmdKLEVBQWFoSixvQkFDYnVILEVBQVl2SCxvQkFJWixNQUFNd0gsRUFBTSxJSXpNRyxNQUNicEksWUFBV0MsR0FBdUIsSUFBdEIsUUFBRXVMLEVBQU8sUUFBRUMsR0FBU3hMLEVBQzlCRSxLQUFLdUwsU0FBV0YsRUFDaEJyTCxLQUFLd0wsU0FBV0YsQ0FDbEIsQ0FFQUcsa0JBQ0UsT0FBT0MsTUFBTyxHQUFFMUwsS0FBS3VMLGlCQUFrQixDQUNyQ0QsUUFBU3RMLEtBQUt3TCxXQUNicEQsS0FBS3BJLEtBQUsyTCxlQUNmLENBQ0FBLGVBQWVmLEdBQ2IsT0FBSUEsRUFBSWdCLEdBQ0NoQixFQUFJaUIsT0FFTkMsUUFBUUMsT0FBUSxTQUFRbkIsRUFBSW9CLFNBQ3JDLENBRUExQixjQUNFLE9BQU9vQixNQUFPLEdBQUUxTCxLQUFLdUwsb0JBQXFCLENBQ3hDVSxPQUFRLE1BQ1JYLFFBQVN0TCxLQUFLd0wsV0FDYnBELEtBQUtwSSxLQUFLMkwsZUFDZixDQUVBcEMsa0JBQWtCcEgsR0FDaEIsT0FBT3VKLE1BQU8sR0FBRTFMLEtBQUt1TCxvQkFBcUIsQ0FDeENVLE9BQVEsUUFDUlgsUUFBU3RMLEtBQUt3TCxTQUNkVSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CckssS0FBTUksRUFBWUosS0FDbEJ3SSxNQUFPcEksRUFBWW9JLFVBRXBCbkMsS0FBS3BJLEtBQUsyTCxlQUNmLENBRUFqQyxXQUFXdkgsR0FDVCxPQUFPdUosTUFBTyxHQUFFMUwsS0FBS3VMLGlCQUFrQixDQUNyQ1UsT0FBUSxPQUNSWCxRQUFTdEwsS0FBS3dMLFNBQ2RVLEtBQU1DLEtBQUtDLFVBQVVqSyxLQUNwQmlHLEtBQUtwSSxLQUFLMkwsZUFDZixDQUNBakIsV0FBV3BGLEdBQ1QsT0FBT29HLE1BQU8sR0FBRTFMLEtBQUt1TCxrQkFBa0JqRyxJQUFVLENBQy9DMkcsT0FBUSxTQUNSWCxRQUFTdEwsS0FBS3dMLFdBQ2JwRCxLQUFLcEksS0FBSzJMLGVBQ2YsQ0FFQWQsYUFBYXZGLEdBQ1gsT0FBT29HLE1BQU8sR0FBRTFMLEtBQUt1TCxrQkFBa0JqRyxVQUFnQixDQUNyRDJHLE9BQVEsTUFDUlgsUUFBU3RMLEtBQUt3TCxXQUNicEQsS0FBS3BJLEtBQUsyTCxlQUNmLENBRUFoQixnQkFBZ0JyRixHQUNkLE9BQU9vRyxNQUFPLEdBQUUxTCxLQUFLdUwsa0JBQWtCakcsVUFBZ0IsQ0FDckQyRyxPQUFRLFNBQ1JYLFFBQVN0TCxLQUFLd0wsV0FDYnBELEtBQUtwSSxLQUFLMkwsZUFDZixDQUVBekQsb0JBQW9CL0YsR0FDbEIsT0FBT3VKLE1BQU8sR0FBRTFMLEtBQUt1TCwyQkFBNEIsQ0FDL0NVLE9BQVEsUUFDUlgsUUFBU3RMLEtBQUt3TCxTQUNkVSxLQUFNQyxLQUFLQyxVQUFVLENBQUVqRSxPQUFRaEcsTUFDOUJpRyxLQUFLcEksS0FBSzJMLGVBQ2YsR0ptSWtCLENBQ2xCTixRQUFTLGtEQUNUQyxRQUFTLENBQ1BlLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBR3BCUCxRQUFRUSxJQUFJLENBQUNyRSxFQUFJcUMsY0FBZXJDLEVBQUl3RCxvQkFDakNyRCxNQUFLdEksSUFBMEIsSUFBeEJ5TSxFQUFVNUMsR0FBUzdKLEVBQ3pCdUksRUFBU21CLFlBQVkrQyxHQUNyQmxFLEVBQVNDLFVBQVVpRSxFQUFTcEUsUUFDNUI1QyxFQUFTZ0gsRUFBUy9CLElBQ2xCVixFQUFpQixJQUFJdkYsRUFDbkIsQ0FDRUUsTUFBT2tGLEVBQ1BqRixTQUFXMkUsSUFDVCxNQUFNbUQsRUFBVTNDLEVBQVdSLEdBQzNCUyxFQUFlOUUsUUFBUXdILEVBQVEsR0R6TjFCLGdCQzhOWDFDLEVBQWVoRixhQUFhLElBRTdCeUQsTUFBTUUsUUFBUWdFLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlQ2xpY2tPdXRzaWRlKTtcbiAgICB0aGlzLmNsb3NlKCk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUNsaWNrT3V0c2lkZSA9IChldnQpID0+IHtcbiAgICBpZiAoXG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSB8fFxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICApIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgY29uc3QgdmFsdWVzID0ge307XG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB2YWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChpbnB1dFZhbHVlcyk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIHNhdmVCdXR0b25UZXh0KSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBzYXZlQnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cbn1cbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG5cbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiIFwiO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVscy5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcbiAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXIpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGl0ZW0pIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG5hbWUsXG4gICAgbGluayxcbiAgICBpc0xpa2VkLFxuICAgIGxpa2VzLFxuICAgIGNhcmRJZCxcbiAgICB1c2VySWQsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGljayxcbiAgICBjYXJkU2VsZWN0b3JcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLmNhcmRJZCA9IGNhcmRJZDtcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpXG4gICAgKTtcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICB9KTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9nZXREYXRhKCkpO1xuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpIHtcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZUxpa2VzKGlzTGlrZWQpIHtcbiAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBfc2hvd0NhcmRMaWtlcygpIHtcbiAgICB0aGlzLl9jYXJkTGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgaWYgKHRoaXMuY2FyZElzTGlrZWQoKSkge1xuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBfZ2V0RGF0YSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZSxcbiAgICAgIGxpbms6IHRoaXMuX2xpbmssXG4gICAgfTtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24gPVxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgdGhpcy5fY2FyZExpa2VDb3VudGVyID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19jb3VudGVyXCIpO1xuICAgIHRoaXMuX2NhcmRMaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2NhcmRMaWtlc0NvdW50O1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgY2FyZFNlY3Rpb246IFwiLmNhcmRzX19saXN0XCIsXG4gIGNhcmRUZW1wbGF0ZTogXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICBwcmV2aWV3TW9kYWw6IFwiI21vZGFsLXByZXZpZXdcIixcbiAgY2FyZFBvcHVwU2VsZWN0b3I6IFwiI2NhcmQtZWRpdC1tb2RhbFwiLFxuICBwcm9maWxlUG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGNoYW5nZUF2aVBvcHVwOiBcIiNjaGFuZ2UtYXZpLWltZ1wiLFxufTtcblxuZXhwb3J0IGNvbnN0IGZvcm1WYWxpZGF0b3JDb25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmV4cG9ydCBjb25zdCBjYXJkQWRkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGF2aUVkaXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjaGFuZ2UtYXZpLWZvcm1cIik7XG5leHBvcnQgY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmV4cG9ydCBjb25zdCB1c2VyTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNvd25lci1uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IHVzZXJEZXNjcmlwdGlvbklucHV0ID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNvd25lci1kZXNjcmlwdGlvblwiKTtcbmV4cG9ydCBjb25zdCBhdmlCdXR0b24gPSBhdmlFZGl0Rm9ybS5xdWVyeVNlbGVjdG9yKFwiLmNoYW5nZS1hdmktZm9ybV9fYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGF2aUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWF2aV9faW1hZ2UtaG92ZXItYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSU1QT1JUUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvblwiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpXCI7XG5pbXBvcnQge1xuICBzZWxlY3RvcnMsXG4gIGZvcm1WYWxpZGF0b3JDb25maWcsXG4gIGNhcmRBZGRGb3JtLFxuICBwcm9maWxlRWRpdEZvcm0sXG4gIGF2aUVkaXRGb3JtLFxuICB1c2VyRGVzY3JpcHRpb25JbnB1dCxcbiAgdXNlck5hbWVJbnB1dCxcbiAgYXZpRWRpdEJ1dHRvbixcbiAgYWRkQ2FyZEJ1dHRvbixcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiO1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDT05TVFMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY29uc3QgYXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuY2hhbmdlQXZpUG9wdXAsIGhhbmRsZUF2aVBvcHVwKTtcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjbW9kYWxfX2RlbGV0ZVwiKTtcbmNvbnN0IHByZXZpZXdJbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFxuICBzZWxlY3RvcnMucHJldmlld01vZGFsLFxuICBoYW5kbGVDYXJkQ2xpY2tcbik7XG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIHNlbGVjdG9ycy5wcm9maWxlUG9wdXBTZWxlY3RvcixcbiAgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXRcbik7XG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgc2VsZWN0b3JzLmNhcmRQb3B1cFNlbGVjdG9yLFxuICBoYW5kbGVDYXJkQWRkQ2xpY2tcbik7XG5jb25zdCBjYXJkU2VsZWN0b3IgPSBzZWxlY3RvcnMuY2FyZFRlbXBsYXRlO1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICB1c2VyTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICB1c2VyRGVzY3JpcHRpb25TZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgdXNlckF2aTogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZVTkNUSU9OUyAmIEhBTkRMRVJTICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xubGV0IG5ld0NhcmRTZWN0aW9uO1xubGV0IHVzZXJJZDtcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGNhcmREYXRhLm5hbWUsXG4gICAgY2FyZERhdGEubGluayxcbiAgICBjYXJkRGF0YS5pc0xpa2VkLFxuICAgIGNhcmREYXRhLmxpa2VzLFxuICAgIGNhcmREYXRhLl9pZCxcbiAgICB1c2VySWQsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGljayxcbiAgICBjYXJkU2VsZWN0b3JcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufVxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgcHJvZmlsZUVkaXRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZUluZm8oaW5wdXRWYWx1ZXMpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMpO1xuICAgICAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwcm9maWxlRWRpdFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UsIFwiU2F2ZVwiKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhhbmRsZUNhcmRBZGRDbGljayhpbnB1dFZhbHVlcykge1xuICBhZGRDYXJkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmFkZE5ld0NhcmQoaW5wdXRWYWx1ZXMpXG4gICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBhZGRDYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gICAgICBuZXdDYXJkU2VjdGlvbi5hZGRJdGVtKGFkZENhcmQpO1xuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlLCBcIkNyZWF0ZVwiKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhhbmRsZUF2aVBvcHVwKGlucHV0VmFsdWVzKSB7XG4gIGF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC51cGRhdGVQcm9maWxlQXZhdGFyKGlucHV0VmFsdWVzLmF2YXRhcilcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRBdmF0YXIoaW5wdXRWYWx1ZXMuYXZhdGFyKTtcbiAgICAgIGF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UsIFwiU2F2ZVwiKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGNhcmQpIHtcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcbiAgZGVsZXRlQ2FyZFBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgZGVsZXRlQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmNhcmRJZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5oYW5kbGVEZWxldGVDYXJkKCk7XG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgfSlcblxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0Q2xpY2soKSB7XG4gIGNvbnN0IHVzZXIgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICB1c2VyTmFtZUlucHV0LnZhbHVlID0gdXNlci5uYW1lO1xuICB1c2VyRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXIuYWJvdXQ7XG4gIHByb2ZpbGVFZGl0UG9wdXAub3BlbigpO1xufVxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcbiAgaWYgKGNhcmQuaXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLnJlbW92ZUNhcmRMaWtlcyhjYXJkLmNhcmRJZClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMuaXNMaWtlZCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGFwaVxuICAgICAgLmFkZENhcmRMaWtlcyhjYXJkLmNhcmRJZClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMuaXNMaWtlZCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9XG59XG5mdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2soY2FyZERhdGEpIHtcbiAgcHJldmlld0ltYWdlUG9wdXAub3BlbihjYXJkRGF0YSk7XG59XG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRk9STSBWQUxJREFUSU9OICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5jb25zdCBhdmlGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRvckNvbmZpZywgYXZpRWRpdEZvcm0pO1xuY29uc3QgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGZvcm1WYWxpZGF0b3JDb25maWcsXG4gIHByb2ZpbGVFZGl0Rm9ybVxuKTtcbmNvbnN0IGNhcmRBZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGZvcm1WYWxpZGF0b3JDb25maWcsXG4gIGNhcmRBZGRGb3JtXG4pO1xuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmNhcmRBZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmF2aUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVWRU5UIExJU1RFTkVSUyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuYXZpRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhdmlGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIGF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgaGFuZGxlUHJvZmlsZUVkaXRDbGljaygpO1xuICBlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uO1xufSk7XG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNhcmRBZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbjtcbiAgY2FyZEFkZEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcbn0pO1xucHJldmlld0ltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnByb2ZpbGVFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFQSSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiOGQxYzhhNGQtZDU5MS00MzAzLTg5YzUtNGIxNTA2YjgzMGIzXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZERhdGFdKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xuICAgIHVzZXJJbmZvLnNldEF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcbiAgICBuZXdDYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogY2FyZERhdGEsXG4gICAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xuICAgICAgICAgIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuICAgICAgICAgIG5ld0NhcmRTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgc2VsZWN0b3JzLmNhcmRTZWN0aW9uXG4gICAgKTtcbiAgICBuZXdDYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZUNvbmZpcm0gPSBhY3Rpb247XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIkxvYWRpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZVN1Ym1pdCA9IChldnQpID0+IHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLl9oYW5kbGVDb25maXJtKCk7XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXQpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcHJldmlld0ltZ1RpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9faW1hZ2UtdGl0bGVcIlxuICAgICk7XG4gICAgdGhpcy5fcHJldmlld0ltZ01vZGFsID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9faW1hZ2UtcHJldmlld1wiXG4gICAgKTtcbiAgfVxuXG4gIG9wZW4oZGF0YSkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9wcmV2aWV3SW1nTW9kYWwuc3JjID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX3ByZXZpZXdJbWdNb2RhbC5hbHQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fcHJldmlld0ltZ1RpdGxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9ycykge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMudXNlck5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHNlbGVjdG9ycy51c2VyRGVzY3JpcHRpb25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5fdXNlckF2aSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLnVzZXJBdmkpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMpIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0VmFsdWVzLm5hbWU7XG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRWYWx1ZXMuYWJvdXQ7XG4gIH1cblxuICBzZXRBdmF0YXIoYXZhdGFyKSB7XG4gICAgdGhpcy5fdXNlckF2aS5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZVByb2ZpbGVJbmZvKGlucHV0VmFsdWVzKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxuICAgICAgICBhYm91dDogaW5wdXRWYWx1ZXMuYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkTmV3Q2FyZChpbnB1dFZhbHVlcykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoaW5wdXRWYWx1ZXMpLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkQ2FyZExpa2VzKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICByZW1vdmVDYXJkTGlrZXMoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZVByb2ZpbGVBdmF0YXIoaW5wdXRWYWx1ZXMpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IGlucHV0VmFsdWVzIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJQb3B1cCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJ0aGlzIiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJldnQiLCJrZXkiLCJjbG9zZSIsInNldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVDbGlja091dHNpZGUiLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3BvcHVwRm9ybSIsIl9zYXZlQnV0dG9uIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsInZhbHVlcyIsImZvckVhY2giLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImlucHV0VmFsdWVzIiwicmVzZXQiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwic2F2ZUJ1dHRvblRleHQiLCJ0ZXh0Q29udGVudCIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJpbnB1dEVsIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9zaG93SW5wdXRFcnJvciIsIl9oaWRlSW5wdXRFcnJvciIsIl9lcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfaW5wdXRFbHMiLCJldmVyeSIsImVuYWJsZVZhbGlkYXRpb24iLCJTZWN0aW9uIiwiY29udGFpbmVyIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCIsIkNhcmQiLCJsaW5rIiwiaXNMaWtlZCIsImxpa2VzIiwiY2FyZElkIiwidXNlcklkIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJjYXJkU2VsZWN0b3IiLCJfbmFtZSIsIl9saW5rIiwiX2xpa2VzIiwiX3VzZXJJZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9jYXJkTGlrZUJ1dHRvbiIsIl9jYXJkRGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZSIsIl9nZXREYXRhIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIl9jYXJkRWxlbWVudCIsIl9yZW5kZXJMaWtlcyIsInVwZGF0ZUxpa2VzIiwiX3Nob3dDYXJkTGlrZXMiLCJfY2FyZExpa2VDb3VudGVyIiwibGVuZ3RoIiwiY2FyZElzTGlrZWQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsIl9jYXJkTGlrZXNDb3VudCIsInNyYyIsImFsdCIsImZvcm1WYWxpZGF0b3JDb25maWciLCJmb3JtU2VsZWN0b3IiLCJjYXJkQWRkRm9ybSIsInByb2ZpbGVFZGl0Rm9ybSIsImF2aUVkaXRGb3JtIiwidXNlck5hbWVJbnB1dCIsInVzZXJEZXNjcmlwdGlvbklucHV0IiwiYXZpRWRpdEJ1dHRvbiIsImFkZENhcmRCdXR0b24iLCJhdmF0YXJQb3B1cCIsImFwaSIsInVwZGF0ZVByb2ZpbGVBdmF0YXIiLCJhdmF0YXIiLCJ0aGVuIiwidXNlckluZm8iLCJzZXRBdmF0YXIiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJmaW5hbGx5IiwicHJvZmlsZUVkaXRCdXR0b24iLCJkZWxldGVDYXJkUG9wdXAiLCJzZXRTdWJtaXRBY3Rpb24iLCJhY3Rpb24iLCJfaGFuZGxlQ29uZmlybSIsIl9oYW5kbGVTdWJtaXQiLCJwcmV2aWV3SW1hZ2VQb3B1cCIsIl9wcmV2aWV3SW1nVGl0bGUiLCJfcHJldmlld0ltZ01vZGFsIiwiZGF0YSIsInByb2ZpbGVFZGl0UG9wdXAiLCJ1cGRhdGVQcm9maWxlSW5mbyIsInNldFVzZXJJbmZvIiwiYWRkQ2FyZFBvcHVwIiwiYWRkTmV3Q2FyZCIsImNhcmREYXRhIiwiYWRkQ2FyZCIsImNyZWF0ZUNhcmQiLCJuZXdDYXJkU2VjdGlvbiIsInNlbGVjdG9ycyIsIl9uYW1lRWxlbWVudCIsInVzZXJOYW1lU2VsZWN0b3IiLCJfZGVzY3JpcHRpb25FbGVtZW50IiwidXNlckRlc2NyaXB0aW9uU2VsZWN0b3IiLCJfdXNlckF2aSIsInVzZXJBdmkiLCJnZXRVc2VySW5mbyIsImFib3V0IiwiX2lkIiwiY2FyZCIsImRlbGV0ZUNhcmQiLCJyZW1vdmVDYXJkTGlrZXMiLCJyZXMiLCJhZGRDYXJkTGlrZXMiLCJhdmlGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciIsImNhcmRBZGRGb3JtVmFsaWRhdG9yIiwidXNlciIsImhhbmRsZVByb2ZpbGVFZGl0Q2xpY2siLCJyZXNldFZhbGlkYXRpb24iLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsIl9jaGVja1Jlc3BvbnNlIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYXV0aG9yaXphdGlvbiIsImFsbCIsInVzZXJEYXRhIiwibmV3Q2FyZCIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==